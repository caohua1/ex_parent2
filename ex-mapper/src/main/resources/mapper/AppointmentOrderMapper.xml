<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ex.dao.AppointmentOrderDao">


	<!--设置预约配置，添加数据-->
	<insert id="insertAppointmentOrder" parameterType="com.ex.entity.AppointmentOrder">
		insert appointment_order (registUserId,productInfoId,registUsername,contactsName,contactsPhone,
		peopleNum,orderNum,merchantName,productName,appointmentMoney,appointmentTime,
		createTime,remark,payWay,payStatus)
		values(#{registUserId},#{productInfoId},#{registUsername},#{contactsName},
		#{contactsPhone},#{peopleNum},#{orderNum},#{merchantName},#{productName},
		#{appointmentMoney},#{appointmentTime},#{createTime},#{remark},#{payWay},
		#{payStatus})
	</insert>

	<!--查询某商家的所有的预约信息-->
	<select id="selectAppointmentOrder" parameterType="java.util.Map" resultType="com.ex.vo.AppointmentOrderVo">
		select ao.*,mr.username username from appointment_order ao
		left join merchant_regist mr on  mr.id = ao.merchantId
		where 1=1
		<if test="username!=null and username !=''">
			and mr.username = #{username}
		</if>
		<if test="startTime!=null and endTime==null">
			and ao.appointmentTime &gt;= #{startTime}
		</if>
		<if test="startTime==null and endTime !=null">
			and ao.appointmentTime &lt;= #{endTime}
		</if>
		<if test="startTime!=null and endTime!=null">
			and ao.appointmentTime BETWEEN #{startTime} AND #{endTime}
		</if>
		and ao.merchantId = #{merchantId}
	</select>

	<!--所有某商家的预约信息的总数量-->
	<select id="selectAppointmentOrderCount" parameterType="java.util.Map" resultType="Integer">
		select count(ao.id) from appointment_order ao
		left join merchant_regist mr on mr.id =  ao.merchantId
		where 1=1
		<if test="username!=null and username !=''">
			and mr.username = #{username}
		</if>
		<if test="startTime!=null and endTime==null">
			and ao.appointmentTime &gt;= #{startTime}
		</if>
		<if test="startTime==null and endTime !=null">
			and ao.appointmentTime &lt;= #{endTime}
		</if>
		<if test="startTime!=null and endTime!=null">
			and ao.appointmentTime BETWEEN #{startTime} AND #{endTime}
		</if>
		and ao.merchantId = #{merchantId}
	</select>
</mapper>